# Generated by Django 5.2.7 on 2025-11-08 13:25

import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('ap', '0002_initial'),
        ('core', '0001_initial'),
        ('finance', '0001_initial'),
        ('segment', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='TaxComponent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('component_type', models.CharField(choices=[('CGST', 'Central GST'), ('SGST', 'State GST'), ('IGST', 'Integrated GST'), ('UGST', 'Union Territory GST'), ('CESS', 'Cess')], max_length=20)),
                ('component_name', models.CharField(max_length=100)),
                ('component_percentage', models.DecimalField(decimal_places=2, help_text='Component percentage of total tax', max_digits=5)),
                ('is_active', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Tax Component',
                'verbose_name_plural': 'Tax Components',
                'ordering': ['tax_rate', 'component_type'],
            },
        ),
        migrations.CreateModel(
            name='TaxJurisdiction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('country_code', models.CharField(db_index=True, help_text='ISO country code (AE, KSA, EG, IN, etc.)', max_length=3, unique=True)),
                ('country_name', models.CharField(max_length=100)),
                ('tax_system', models.CharField(choices=[('VAT', 'Value Added Tax'), ('GST', 'Goods and Services Tax'), ('SALES_TAX', 'Sales Tax')], max_length=20)),
                ('standard_rate', models.DecimalField(decimal_places=2, help_text='Standard tax rate as percentage', max_digits=5)),
                ('tax_authority_name', models.CharField(help_text='Name of tax authority', max_length=200)),
                ('tax_registration_number', models.CharField(blank=True, help_text="Company's tax registration number", max_length=100)),
                ('tax_period', models.CharField(choices=[('MONTHLY', 'Monthly'), ('QUARTERLY', 'Quarterly'), ('ANNUAL', 'Annual')], default='MONTHLY', max_length=20)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Tax Jurisdiction',
                'verbose_name_plural': 'Tax Jurisdictions',
                'ordering': ['country_code'],
            },
        ),
        migrations.CreateModel(
            name='TaxPeriod',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('period_start', models.DateField(db_index=True)),
                ('period_end', models.DateField(db_index=True)),
                ('period_name', models.CharField(help_text="e.g., '2024-Q1', '2024-Jan', '2024'", max_length=50)),
                ('output_tax', models.DecimalField(decimal_places=2, default=0, help_text='Tax collected on sales', max_digits=15)),
                ('input_tax', models.DecimalField(decimal_places=2, default=0, help_text='Tax paid on purchases', max_digits=15)),
                ('net_tax_payable', models.DecimalField(decimal_places=2, default=0, help_text='Output tax - Input tax', max_digits=15)),
                ('status', models.CharField(choices=[('OPEN', 'Open'), ('CLOSED', 'Closed'), ('FILED', 'Filed'), ('PAID', 'Paid')], db_index=True, default='OPEN', max_length=20)),
                ('filing_due_date', models.DateField(blank=True, null=True)),
                ('filed_date', models.DateField(blank=True, null=True)),
                ('payment_date', models.DateField(blank=True, null=True)),
                ('payment_reference', models.CharField(blank=True, max_length=100)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Tax Period',
                'verbose_name_plural': 'Tax Periods',
                'ordering': ['-period_end'],
            },
        ),
        migrations.CreateModel(
            name='TaxRate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('rate_type', models.CharField(choices=[('STANDARD', 'Standard Rate'), ('ZERO', 'Zero-Rated'), ('EXEMPT', 'Tax Exempt'), ('REVERSE_CHARGE', 'Reverse Charge'), ('REDUCED', 'Reduced Rate')], db_index=True, max_length=20)),
                ('rate_code', models.CharField(db_index=True, help_text='Short code (e.g., STD, ZR, EX, RC)', max_length=20)),
                ('rate_name', models.CharField(max_length=100)),
                ('rate_percentage', models.DecimalField(decimal_places=2, help_text='Tax rate as percentage', max_digits=5)),
                ('description', models.TextField(blank=True)),
                ('applicable_to', models.CharField(blank=True, help_text='What this rate applies to', max_length=200)),
                ('effective_from', models.DateField()),
                ('effective_to', models.DateField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('is_default', models.BooleanField(default=False, help_text='Default rate for this jurisdiction and type')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Tax Rate',
                'verbose_name_plural': 'Tax Rates',
                'ordering': ['jurisdiction', 'rate_type', '-effective_from'],
            },
        ),
        migrations.CreateModel(
            name='APPaymentBatch',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('batch_number', models.CharField(db_index=True, max_length=50, unique=True)),
                ('batch_date', models.DateField(default=django.utils.timezone.now)),
                ('payment_date', models.DateField(help_text='Date when payments will be made')),
                ('payment_method', models.CharField(choices=[('BANK_TRANSFER', 'Bank Transfer'), ('CHECK', 'Check'), ('CASH', 'Cash'), ('CREDIT_CARD', 'Credit Card'), ('ACH', 'ACH Transfer'), ('WIRE', 'Wire Transfer')], max_length=20)),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, help_text='Total payment amount', max_digits=15)),
                ('payment_count', models.IntegerField(default=0, help_text='Number of payments in batch')),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('SUBMITTED', 'Submitted'), ('APPROVED', 'Approved'), ('PROCESSING', 'Processing'), ('POSTED_TO_FINANCE', 'Posted to Finance'), ('RECONCILED', 'Reconciled'), ('REJECTED', 'Rejected'), ('CANCELLED', 'Cancelled')], db_index=True, default='DRAFT', max_length=20)),
                ('posted_to_finance_date', models.DateTimeField(blank=True, null=True)),
                ('is_reconciled', models.BooleanField(default=False)),
                ('reconciled_date', models.DateField(blank=True, null=True)),
                ('submitted_date', models.DateTimeField(blank=True, null=True)),
                ('approved_date', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_payment_batches', to=settings.AUTH_USER_MODEL)),
                ('bank_account', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='payment_batches', to='finance.bankaccount')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_payment_batches', to=settings.AUTH_USER_MODEL)),
                ('currency', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='core.currency')),
                ('journal_entry', models.ForeignKey(blank=True, help_text='Created journal entry in Finance', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='payment_batch', to='finance.journalentry')),
                ('posted_to_finance_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='posted_payment_batches', to=settings.AUTH_USER_MODEL)),
                ('reconciled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='reconciled_payment_batches', to=settings.AUTH_USER_MODEL)),
                ('submitted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='submitted_payment_batches', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='updated_payment_batches', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'AP Payment Batch',
                'verbose_name_plural': 'AP Payment Batches',
                'db_table': 'payment_integration_appaymentbatch',
                'ordering': ['-batch_date', '-batch_number'],
            },
        ),
        migrations.CreateModel(
            name='APPaymentLine',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('line_number', models.IntegerField()),
                ('payment_amount', models.DecimalField(decimal_places=2, help_text='Amount to pay (may be partial)', max_digits=15)),
                ('withholding_tax_rate', models.DecimalField(decimal_places=2, default=0, help_text='Withholding tax rate as percentage', max_digits=5)),
                ('withholding_tax_amount', models.DecimalField(decimal_places=2, default=0, help_text='Withholding tax amount', max_digits=15)),
                ('net_payment_amount', models.DecimalField(decimal_places=2, default=0, help_text='Net amount paid to supplier', max_digits=15)),
                ('discount_taken', models.DecimalField(decimal_places=2, default=0, help_text='Early payment discount taken', max_digits=15)),
                ('is_paid', models.BooleanField(default=False)),
                ('paid_date', models.DateField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('ap_invoice', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='payment_lines', to='ap.apinvoice')),
                ('payment_batch', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payment_lines', to='payments.appaymentbatch')),
                ('withholding_tax_account', models.ForeignKey(blank=True, help_text='GL account for withholding tax', null=True, on_delete=django.db.models.deletion.PROTECT, related_name='withholding_tax_lines', to='segment.xx_segment')),
            ],
            options={
                'verbose_name': 'AP Payment Line',
                'verbose_name_plural': 'AP Payment Lines',
                'ordering': ['line_number'],
            },
        ),
        migrations.CreateModel(
            name='CorporateTaxAccrual',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('fiscal_year', models.IntegerField(db_index=True)),
                ('period_month', models.IntegerField(help_text='Month (1-12)')),
                ('period_quarter', models.IntegerField(help_text='Quarter (1-4)')),
                ('revenue', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('expenses', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('profit_before_tax', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('tax_rate', models.DecimalField(decimal_places=2, help_text='Corporate tax rate as percentage', max_digits=5)),
                ('tax_amount', models.DecimalField(decimal_places=2, default=0, help_text='Accrued tax amount', max_digits=15)),
                ('cumulative_profit_before_tax', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('cumulative_tax_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('is_posted', models.BooleanField(default=False)),
                ('posted_date', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('journal_entry', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='corporate_tax_accrual', to='finance.journalentry')),
                ('posted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='posted_tax_accruals', to=settings.AUTH_USER_MODEL)),
                ('tax_expense_account', models.ForeignKey(help_text='Tax expense account (P&L)', on_delete=django.db.models.deletion.PROTECT, related_name='corporate_tax_expenses', to='segment.xx_segment')),
                ('tax_payable_account', models.ForeignKey(help_text='Tax payable account (Balance Sheet)', on_delete=django.db.models.deletion.PROTECT, related_name='corporate_tax_payables', to='segment.xx_segment')),
            ],
            options={
                'verbose_name': 'Corporate Tax Accrual',
                'verbose_name_plural': 'Corporate Tax Accruals',
                'ordering': ['-fiscal_year', '-period_month'],
            },
        ),
        migrations.CreateModel(
            name='PaymentRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('request_number', models.CharField(db_index=True, max_length=50, unique=True)),
                ('payment_method', models.CharField(choices=[('BANK_TRANSFER', 'Bank Transfer'), ('CHECK', 'Check'), ('CASH', 'Cash'), ('CREDIT_CARD', 'Credit Card'), ('WIRE', 'Wire Transfer'), ('ACH', 'ACH Transfer'), ('OTHER', 'Other')], default='BANK_TRANSFER', max_length=20)),
                ('requested_date', models.DateField(default=django.utils.timezone.now)),
                ('requested_payment_date', models.DateField(help_text='Date when payment should be made')),
                ('payment_amount', models.DecimalField(decimal_places=2, max_digits=15)),
                ('exchange_rate', models.DecimalField(decimal_places=6, default=1, max_digits=15)),
                ('base_currency_amount', models.DecimalField(decimal_places=2, default=0, help_text='Amount in base currency', max_digits=15)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('SUBMITTED', 'Submitted'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected'), ('SCHEDULED', 'Scheduled for Payment'), ('PAID', 'Paid'), ('CANCELLED', 'Cancelled'), ('CLOSED', 'Closed')], db_index=True, default='DRAFT', max_length=20)),
                ('priority', models.CharField(choices=[('LOW', 'Low'), ('NORMAL', 'Normal'), ('HIGH', 'High'), ('URGENT', 'Urgent')], default='NORMAL', max_length=10)),
                ('approval_required', models.BooleanField(default=True)),
                ('approved_date', models.DateTimeField(blank=True, null=True)),
                ('scheduled_date', models.DateField(blank=True, null=True)),
                ('paid_date', models.DateField(blank=True, null=True)),
                ('payment_reference', models.CharField(blank=True, help_text='Bank reference or check number', max_length=100)),
                ('purpose', models.TextField(help_text='Purpose or reason for payment')),
                ('notes', models.TextField(blank=True)),
                ('attachment_url', models.URLField(blank=True, help_text='Link to supporting documents')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_payment_requests', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_payment_requests', to=settings.AUTH_USER_MODEL)),
                ('currency', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='core.currency')),
                ('payment_batch', models.ForeignKey(blank=True, help_text='Payment batch this request belongs to', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='payment_requests', to='payments.appaymentbatch')),
                ('supplier', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='payment_requests', to='ap.supplier')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='updated_payment_requests', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Payment Request',
                'verbose_name_plural': 'Payment Requests',
                'db_table': 'payment_integration_paymentrequest',
                'ordering': ['-requested_date', '-created_at'],
            },
        ),
    ]
